{% extends "dashboard/farmer/base_farmer.html" %} {% block dashboard_content %}

<div class="bg-white rounded-2xl shadow p-6">
  <h2 class="text-2xl font-bold text-green-800 mb-6 flex items-center gap-2">
    <span>📋</span> My Cases
  </h2>

  {% if cases_count == 0 %}
  <div class="text-center py-12">
    <div class="text-6xl mb-4">📂</div>
    <p class="text-green-700 text-lg mb-4">You haven't opened any cases yet.</p>
    <a
      href="{% url 'farmer_detect_disease' %}"
      class="inline-block bg-green-600 text-white px-6 py-2 rounded-lg hover:bg-green-700 transition"
    >
      Analyze Plant & Open Case
    </a>
  </div>
  {% else %}
  <div class="overflow-x-auto">
    <table class="min-w-full divide-y divide-green-200">
      <thead class="bg-green-50">
        <tr>
          <th
            class="px-6 py-3 text-left text-xs font-medium text-green-700 uppercase tracking-wider"
          >
            Case ID
          </th>
          <th
            class="px-6 py-3 text-left text-xs font-medium text-green-700 uppercase tracking-wider"
          >
            Crop & Disease
          </th>
          <th
            class="px-6 py-3 text-left text-xs font-medium text-green-700 uppercase tracking-wider"
          >
            Status
          </th>
          <th
            class="px-6 py-3 text-left text-xs font-medium text-green-700 uppercase tracking-wider"
          >
            Created
          </th>
          <th
            class="px-6 py-3 text-left text-xs font-medium text-green-700 uppercase tracking-wider"
          >
            Actions
          </th>
        </tr>
      </thead>
      <tbody class="bg-white divide-y divide-green-200">
        {% for case in cases %}
        <tr class="hover:bg-green-50 transition">
          <!-- Case ID -->
          <td
            class="px-6 py-4 whitespace-nowrap text-sm font-medium text-green-900"
          >
            #{{ case.id }}
          </td>

          <!-- Crop & Disease -->
          <td class="px-6 py-4 whitespace-nowrap">
            <div class="text-sm font-medium text-green-900">
              {{ case.analysis.crop_name }}
            </div>
            <div class="text-sm text-green-600">
              {{ case.analysis.disease_name }}
            </div>
          </td>

          <!-- Status -->
          <td class="px-6 py-4 whitespace-nowrap">
            <span
              class="px-2 py-1 text-xs font-medium rounded-full {% if case.status == 'resolved' %}bg-green-100 text-green-800 {% else %}bg-yellow-100 text-yellow-800{% endif %}"
            >
              {% if case.status == 'resolved' %}✅ Resolved {% else %}⏳
              Pending{% endif %}
            </span>
          </td>

          <!-- Created Date -->
          <td class="px-6 py-4 whitespace-nowrap text-sm text-green-600">
            {{ case.created_at|date:"M d, Y" }}
          </td>

          <!-- Actions -->
          <td class="px-6 py-4 whitespace-nowrap text-sm font-medium">
            <a
              href="{% url 'farmer_case_detail' case.id %}"
              class="text-green-600 hover:text-green-800 mr-3"
            >
              View
            </a>
          </td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>

  <!-- Case Count Summary (simplified without pagination info) -->
  <div class="mt-4 text-sm text-green-600">
    Total: {{ cases_count }} case{{ cases_count|pluralize }}
  </div>
  {% endif %}
</div>

{% endblock %}
