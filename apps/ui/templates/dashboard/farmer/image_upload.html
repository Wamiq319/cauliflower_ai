{% extends "dashboard/farmer/base_farmer.html" %} {% block dashboard_content %}

<div class="grid md:grid-cols-2 gap-8 items-start">
  <!-- Upload Section -->
  <div class="bg-white rounded-2xl shadow p-6">
    <h2 class="text-2xl font-bold text-green-800 mb-4 flex items-center gap-2">
      <span>ðŸ”¬</span> Analyze Image
    </h2>
    <p class="text-green-700 mb-4">
      Upload your plant image below to analyze for potential diseases.
    </p>
    <form class="space-y-4">
      <input
        type="file"
        accept="image/*"
        id="imageInput"
        class="block w-full text-green-800 border border-green-300 rounded px-3 py-2 bg-green-50"
      />
      <div id="imagePreview" class="mt-4 hidden">
        <img
          id="preview"
          class="rounded-lg border border-green-200 max-h-60 object-contain"
          alt="Uploaded Image Preview"
        />
      </div>
    </form>
  </div>

  <!-- Result Section -->
  <div
    id="resultContainer"
    class="bg-green-50 rounded-2xl shadow p-6 space-y-4"
    style="display: none"
  >
    <h2 class="text-2xl font-bold text-green-800 mb-2 flex items-center gap-2">
      <span>ðŸ¦ </span> Detection Result
    </h2>

    <div>
      <div class="text-green-700">
        <span class="font-semibold">Crop:</span> {{ result.crop_name }}
      </div>
      <div class="text-green-700">
        <span class="font-semibold">Disease:</span> {{ result.disease_name }}
      </div>
    </div>

    <div>
      <h3 class="text-lg font-semibold text-green-800">
        Recommended Treatments
      </h3>
      <ul class="list-disc list-inside text-green-700 space-y-1">
        {% for tip in result.suggestions %}
        <li>{{ tip }}</li>
        {% endfor %}
      </ul>
    </div>

    <div class="text-sm text-green-600">
      <span class="font-semibold">Suggested by:</span> {{ result.suggested_by }}
    </div>
  </div>
</div>

<script>
  const imageInput = document.getElementById("imageInput");
  const preview = document.getElementById("preview");
  const imagePreview = document.getElementById("imagePreview");
  const resultContainer = document.getElementById("resultContainer");

  imageInput.addEventListener("change", function () {
    const file = this.files[0];
    if (!file) return;

    const reader = new FileReader();
    reader.onload = function (e) {
      preview.src = e.target.result;
      imagePreview.classList.remove("hidden");
      resultContainer.style.display = "block";
    };
    reader.readAsDataURL(file);
  });
</script>

{% endblock %}
