{% extends "dashboard/farmer/base_farmer.html" %} {% block dashboard_content %}

<div class="bg-white rounded-2xl shadow p-6">
  <h2 class="text-2xl font-bold text-green-800 mb-6 flex items-center gap-2">
    <span>ðŸ“Š</span> Past Analyzed
  </h2>

  <div id="analysis-container" class="space-y-4">
    {% for analysis in past_analyses %}
    <div
      class="analysis-card bg-green-50 border border-green-200 rounded-xl p-4 hover:shadow-md transition hidden"
    >
      <div class="flex items-center justify-between gap-4">
        <div class="flex items-center gap-4">
          <div class="text-5xl">ðŸŒ¿</div>
          <div>
            <div class="text-lg font-bold text-green-800">
              {{ analysis.disease_name }}
            </div>
            <div class="text-sm text-green-600">
              {{ analysis.crop_name }} â€” {{ analysis.date }}
            </div>
          </div>
        </div>
        <div class="flex items-center gap-4">
          <div class="text-sm font-medium text-green-700">
            Confidence:
            <span class="font-bold text-green-900"
              >{{ analysis.confidence }}</span
            >
          </div>
          <button
            type="button"
            class="view-btn bg-green-700 text-white px-4 py-2 rounded hover:bg-green-800 transition"
            data-id="{{ forloop.counter0 }}"
          >
            View
          </button>
        </div>
      </div>
    </div>

    <!-- Modal -->
    <div
      id="modal-{{ forloop.counter0 }}"
      class="modal fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center z-50"
    >
      <div class="bg-white rounded-lg w-full max-w-md p-6 relative">
        <h3 class="text-xl font-bold text-green-800 mb-2">
          {{ analysis.disease_name }}
        </h3>
        <div class="text-sm text-green-600 mb-2">
          {{ analysis.crop_name }} â€” {{ analysis.date }}
        </div>
        <div class="text-sm font-medium text-green-700 mb-4">
          Confidence:
          <span class="font-bold text-green-900"
            >{{ analysis.confidence }}</span
          >
        </div>
        <div
          class="w-full h-40 bg-green-100 rounded flex items-center justify-center text-5xl mb-4"
        >
          ðŸŒ¿
        </div>
        <h4 class="text-green-700 font-semibold mb-2">Suggestions:</h4>
        <ul class="list-disc list-inside text-green-700 space-y-1 text-sm">
          {% for suggestion in analysis.suggestions %}
          <li>{{ suggestion }}</li>
          {% endfor %}
        </ul>
        <!-- Green Close Button -->
        <div class="mt-6 text-right">
          <button
            type="button"
            class="close-btn bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700 transition"
            data-id="{{ forloop.counter0 }}"
          >
            Close
          </button>
        </div>
      </div>
    </div>
    {% endfor %}
  </div>

  <!-- Pagination Controls -->
  <div id="pagination-controls" class="flex justify-center mt-6 gap-2"></div>
</div>

{% endblock %}
